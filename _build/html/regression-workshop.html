
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>PCHN63101 Regression Workshop &#8212; LM I: Simple and Multiple Regression</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/test.css?v=90b7ad94" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'regression-workshop';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="0.intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="LM I: Simple and Multiple Regression - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="LM I: Simple and Multiple Regression - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="0.intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1.straight-line.html">Fitting a Straight Line to Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.simple-regression.html">The Simple Regression Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.maximum-likelihood.html">Maximum Likelihood</a></li>
<li class="toctree-l1"><a class="reference internal" href="4.estimated-model.html">The Estimated Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="5.multiple-regression.html">Multiple Linear Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="summary.html">Summary</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/PCHN63101-Advanced-Data-Skills/Simple-Multiple-Regression" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/PCHN63101-Advanced-Data-Skills/Simple-Multiple-Regression/issues/new?title=Issue%20on%20page%20%2Fregression-workshop.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/regression-workshop.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>PCHN63101 Regression Workshop</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#minimising-error-with-a-line">Minimising Error With a Line</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#maximum-likelihood">Maximum Likelihood</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#different-model-equations">Different Model Equations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regression-as-a-mean-and-variance-function">Regression as a Mean and Variance Function</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#predictive-accuracy">Predictive Accuracy</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#intercepts-and-the-r-formula-interface">Intercepts and the <code class="docutils literal notranslate"><span class="pre">R</span></code> Formula Interface</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#declaring-an-intercept">Declaring an Intercept</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#removing-the-intercept">Removing the Intercept</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#formula-shortcuts">Formula Shortcuts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regression-through-the-origin">Regression Through the Origin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-centering">Mean Centering</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualising-regression">Visualising Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-regession-and-ggplot2">Simple Regession and <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-regression-and-ggplot2">Multiple Regression and <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualising-the-regression-plane">Visualising the Regression Plane</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="pchn63101-regression-workshop">
<h1>PCHN63101 Regression Workshop<a class="headerlink" href="#pchn63101-regression-workshop" title="Link to this heading">#</a></h1>
<p>In the accompanying lesson to this workshop we explored both simple and multiple regression as core modelling tools in statistics. Indeed, regression is the foundation of <em>everything</em> we will be studying going forward. Once you understand regression, you understand the vast majority of applied statistics. Because of this, it is <em>essential</em> that you are as comfortable as possible with the regression framework, otherwise you will be lost going forward. In this workshop, the aim is to provide more concrete examples of many of the key concepts from the lesson. As with last week, demonstrating statistical theory within <code class="docutils literal notranslate"><span class="pre">R</span></code> allows you to gain more intuition, particularly as you can play around with the code and see the consequences. It can also help you gain a more detailed understanding of the mathematical notation by seeing it represented within code. Together, this should help solidify your understanding of many of the ideas behind regression, statistical models, estimation, visualisation and the <code class="docutils literal notranslate"><span class="pre">R</span></code> formula interface.</p>
<section id="minimising-error-with-a-line">
<h2>Minimising Error With a Line<a class="headerlink" href="#minimising-error-with-a-line" title="Link to this heading">#</a></h2>
<p>To begin with, we will explore the idea of the “best” regression line being the one that <em>minimises</em> the error sums-of-squares. Although easy enough to state that the least-squares solutions are the ones that make this quantity as <em>small</em> as possible, it can be useful to actually demonstrate this. The code below is set to produce a regression line, which is visualised in the plot below. Do not worry about the code that adjusts the plot limits, this is just to prevent the regression line from disappearing from the plot, even with arbitrary parameter values. The important point is that the error sums-of-squares are displayed in the title of the plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">data</span><span class="p">(</span><span class="n">mtcars</span><span class="p">)</span>
<span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span>
<span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mtcars</span><span class="o">$</span><span class="n">wt</span>


<span class="n">beta.0</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="c1"># CHANGE THIS</span>
<span class="n">beta.1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0</span><span class="w">  </span><span class="c1"># CHANGE THIS</span>


<span class="c1"># regression line</span>
<span class="n">y.hat</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">beta.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beta.1</span><span class="o">*</span><span class="n">x</span>

<span class="c1"># error sum-of-squares</span>
<span class="n">error.SS</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">((</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">y.hat</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="p">)</span>

<span class="c1"># figure out y-limits based on the range of estimated values and the data</span>
<span class="n">est.lims</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">beta.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beta.1</span><span class="o">*</span><span class="nf">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>
<span class="w">               </span><span class="n">beta.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beta.1</span><span class="o">*</span><span class="nf">max</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">est.range</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">min</span><span class="p">(</span><span class="n">est.lims</span><span class="p">),</span><span class="nf">max</span><span class="p">(</span><span class="n">est.lims</span><span class="p">))</span>
<span class="n">plot.lim</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">min</span><span class="p">(</span><span class="nf">min</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="n">est.range</span><span class="p">[</span><span class="m">1</span><span class="p">]),</span><span class="w"> </span>
<span class="w">               </span><span class="nf">max</span><span class="p">(</span><span class="nf">max</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="n">est.range</span><span class="p">[</span><span class="m">2</span><span class="p">]))</span>

<span class="c1"># printing precision of the error SS (e.g. %.5f would display 5 decimal places)</span>
<span class="n">ESS.print</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;%.3f&quot;</span><span class="p">,</span><span class="n">error.SS</span><span class="p">)</span><span class="w"> </span>

<span class="c1"># plot data and regression line</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="nf">paste0</span><span class="p">(</span><span class="s">&quot;Error SS = &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ESS.print</span><span class="p">),</span><span class="w"> </span><span class="n">ylim</span><span class="o">=</span><span class="n">plot.lim</span><span class="p">,</span><span class="w"> </span><span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">5.5</span><span class="p">))</span>
<span class="nf">abline</span><span class="p">(</span><span class="n">coef</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">beta.0</span><span class="p">,</span><span class="n">beta.1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/14a42d044794d6d37462a7e19f2ffea1602b907d6cb142466993ae6d5a52f949.png"><img alt="_images/14a42d044794d6d37462a7e19f2ffea1602b907d6cb142466993ae6d5a52f949.png" src="_images/14a42d044794d6d37462a7e19f2ffea1602b907d6cb142466993ae6d5a52f949.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<div class="alert alert-block alert-info"> 
<b>ACTIVITY</b> Try changing the values of <code>beta.0</code> and <code>beta.1</code> in the code above. Can you find the OLS estimates by making the error sum-of-squares as small as possible? You can move the line up and down by changing <code>beta.0</code> and then adjust its angle using <code>beta.1</code>.
</div></section>
<section id="maximum-likelihood">
<h2>Maximum Likelihood<a class="headerlink" href="#maximum-likelihood" title="Link to this heading">#</a></h2>
<p>In the accompanying lesson, we discussed both <em>least-squares</em> and <em>maximum likelihood</em> as options for estimating regression models. Due to its simplicity and the availbility of closed-form solutions, least-squares is usually preferred. However, maximum likelihood is used more generally because it can be applied to situations where no closed-form solution exists. This is particularly true of models that that use a <em>different</em> distributions to the normal distribution. As such, maximum likelihood is an approach that will be more applicable in future. There is also no loss of generality, given that least-squares and (restricted) maximum likelihood produce the <em>same</em> estimates under normality. As such, if we want to make our lives easier, we can just ignore least-squares and use maximum likelihood for everything.</p>
<p>Although possible to derive closed-form solutions using maximum likelihood, for situations where this is not possible we can make use of <em>iterative</em> maximum likelihood. Effectively, this involves getting the computer to search through hundreds or thousands of guesses for the parameters to try and find the “best” ones. This is effectively what you were doing in the example above. The only difference was that we were using the least-squares criteria for defining “best” rather than the probability-based likelihood criteria. So, let us start by saving the least-squares estimates so we can compare.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mod</span><span class="w">             </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">wt</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">)</span>
<span class="n">ols.ests</span><span class="w">        </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">coef</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span>
<span class="n">ols.ests</span><span class="w">        </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">ols.ests</span><span class="p">,</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span><span class="o">$</span><span class="n">sigma</span><span class="p">)</span>
<span class="nf">names</span><span class="p">(</span><span class="n">ols.ests</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;beta.0&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;beta.1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;sigma&quot;</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="n">ols.ests</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   beta.0    beta.1     sigma 
37.285126 -5.344472  3.045882 
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-info"> 
<b>ACTIVITY</b> How close were you to finding the OLS estimates in the example earlier? Try inserting the OLS estimates into that code and see how close the true minimum error sum-of-squares was to the value you managed to get. 
<p><i>TIP</i> If you are <i>very</i> close, you may need to adjust the printing precision of the error sums-of-squares as the differences may be hidden deep in the demimal places. About 15 decimal places is generally the tolerance you can use for accurate numbers.</p>
</div><p>In the field of numeric computing, methods that search around to find the “best” parameters are known as <em>optimisation</em> algorithms. To gain a bit more intuition about this, we will have a brief look at optimisation within the context of maximum likelihood. In practice, you would never need to implement this type of approach yourself, but it can be helpful to see it when learning. Within <code class="docutils literal notranslate"><span class="pre">R</span></code>, the functions <code class="docutils literal notranslate"><span class="pre">nlm()</span></code> can be used for optimisation (<code class="docutils literal notranslate"><span class="pre">n</span></code>on<code class="docutils literal notranslate"><span class="pre">l</span></code>inear <code class="docutils literal notranslate"><span class="pre">m</span></code>inimisation). This function needs some starting guesses for the parameters, so in the example below we set <code class="docutils literal notranslate"><span class="pre">beta.0</span> <span class="pre">&lt;-</span> <span class="pre">mean(y)</span></code>, <code class="docutils literal notranslate"><span class="pre">beta.1</span> <span class="pre">&lt;-</span> <span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">sigma</span> <span class="pre">&lt;-</span> <span class="pre">sd(y)</span></code>. As the name implies, this function <em>minimises</em>, so we need to return the <em>negative</em> log-likelihood.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define negative log-likelihood function</span>
<span class="n">neg.loglik</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">params</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">beta.0</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">params</span><span class="p">[</span><span class="m">1</span><span class="p">]</span>
<span class="w">  </span><span class="n">beta.1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">params</span><span class="p">[</span><span class="m">2</span><span class="p">]</span>
<span class="w">  </span><span class="n">sigma</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">params</span><span class="p">[</span><span class="m">3</span><span class="p">]</span>

<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="n">sigma</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="kr">return</span><span class="p">(</span><span class="m">1e10</span><span class="p">)</span>

<span class="w">  </span><span class="n">mu</span><span class="w">     </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">beta.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beta.1</span><span class="o">*</span><span class="n">x</span><span class="w">    </span>
<span class="w">  </span><span class="n">loglik</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="nf">dnorm</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">sd</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span><span class="w"> </span><span class="n">log</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">))</span><span class="w"> </span><span class="c1"># log-likelihood</span>
<span class="w">  </span><span class="kr">return</span><span class="p">(</span><span class="o">-</span><span class="n">loglik</span><span class="p">)</span><span class="w">                                      </span><span class="c1"># -ve log-likelihood</span>
<span class="p">}</span>

<span class="c1"># data</span>
<span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mtcars</span><span class="o">$</span><span class="n">wt</span>
<span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span>

<span class="c1"># Starting values (guesses for intercept, slope and SD)</span>
<span class="n">init.params</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">mean</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="nf">sd</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>

<span class="c1"># Run optimisation</span>
<span class="n">mle</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">nlm</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">neg.loglik</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">=</span><span class="n">init.params</span><span class="p">)</span>

<span class="c1"># Results</span>
<span class="n">mle.ests</span><span class="w">        </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mle</span><span class="o">$</span><span class="n">estimate</span>
<span class="nf">names</span><span class="p">(</span><span class="n">mle.ests</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;beta.0&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;beta.1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;sigma&quot;</span><span class="p">)</span>

<span class="c1"># Print</span>
<span class="nf">cat</span><span class="p">(</span><span class="nf">paste0</span><span class="p">(</span><span class="s">&quot;MLE Estimation complete in &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">mle</span><span class="o">$</span><span class="n">iterations</span><span class="p">,</span><span class="w"> </span><span class="s">&quot; iterations\n\n&quot;</span><span class="p">))</span>
<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;MLE estimates:\n&quot;</span><span class="p">)</span>
<span class="nf">cat</span><span class="p">(</span><span class="n">mle.ests</span><span class="p">)</span>
<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;\n\nOLS estimates:\n&quot;</span><span class="p">)</span>
<span class="nf">cat</span><span class="p">(</span><span class="n">ols.ests</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MLE Estimation complete in 15 iterations

MLE estimates:
37.28513 -5.344472 2.949163

OLS estimates:
37.28513 -5.344472 3.045882
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-info"> 
<b>ACTIVITY</b> Try changing the starting values in <code>init.params</code>. What does this do to the number of iterations required? Can you break the estimation and get the algorithm to converge on very different parameter estimates? What does this tell you about the sensitivity of optimisation to its starting point?
</div><p>As we can see above, and as explained in the lesson, the variance estimation from maximum likelihood is <em>biased</em> as it does not implement Bessel’s correction. Restricted maximum likelihood (REML) is therefore the preferred option in practice. However, this is more complex to demonstrate and so we will not discuss it in any more detail.</p>
<div class="alert alert-block alert-danger"> 
<b>IMPORTANT</b> Remember that iterative maximum likelihood is <i>not</i> needed for regression problems. We just used it above for demonstration purposes. The closed-form solutions that can be derived from the likelihood principle end up being <i>identical</i> to those from least-squares, so the methods converge. As such, we can conceptualise regressions problems as using <i>either</i> estimation approach, as they both result in the same equations and the same quantities, just derived from different perspectives.
</div></section>
<section id="different-model-equations">
<h2>Different Model Equations<a class="headerlink" href="#different-model-equations" title="Link to this heading">#</a></h2>
<p>Within the accompanying lesson, we discussed how the regression model can be written two equivalent ways:</p>
<div class="math notranslate nohighlight">
\[
y_{i} \sim \mathcal{N}\left(\beta_{0} + \beta_{1}x_{i}, \sigma^{2}\right)
\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{alignat*}{1}
    y_{i}        &amp;=    \beta_{0} + \beta_{1}x_{i} + \epsilon_{i} \\
    \epsilon_{i} &amp;\sim \mathcal{N}\left(0, \sigma^{2}\right)
\end{alignat*}
\end{split}\]</div>
<p>Students sometimes find this confusing and struggle to connect the two. To help, we have provided code below that shows simulated data generated using <em>both</em> forms of model equation. As long as we set the random seed to the same number each time, we can show that the simulated data is <em>identical</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">n</span><span class="w">      </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">100</span>
<span class="n">x</span><span class="w">      </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="n">from</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="o">=</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="n">length.out</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="n">beta.0</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">5</span>
<span class="n">beta.1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0.5</span>
<span class="n">sigma</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0.2</span>

<span class="nf">set.seed</span><span class="p">(</span><span class="m">666</span><span class="p">)</span>
<span class="c1">#===================================================#</span>
<span class="c1"># y ~ N(beta.0 + beta.1*x, sigma)                   #</span>
<span class="c1">#===================================================#</span>
<span class="n">y.1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="o">=</span><span class="n">beta.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beta.1</span><span class="o">*</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">sd</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>

<span class="nf">set.seed</span><span class="p">(</span><span class="m">666</span><span class="p">)</span>
<span class="c1">#===================================================#</span>
<span class="c1"># y = beta.0 + beta.1*x + e                         #</span>
<span class="c1"># e ~ N(0, sigma)                                   #</span>
<span class="c1">#===================================================#</span>
<span class="n">err</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="o">=</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">sd</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>
<span class="n">y.2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">beta.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beta.1</span><span class="o">*</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">err</span>

<span class="c1"># plots</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y.1</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="s">&quot;y ~ N(β0 + β1*x, σ2)&quot;</span><span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y.2</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="s">&quot;y = β0 + β1*x + ε\nε ~ N(0,σ2)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/c9d363155f4421a777db4841646b98ae0dd271eb5ff05e3ad9e647cd1b01bad1.png"><img alt="_images/c9d363155f4421a777db4841646b98ae0dd271eb5ff05e3ad9e647cd1b01bad1.png" src="_images/c9d363155f4421a777db4841646b98ae0dd271eb5ff05e3ad9e647cd1b01bad1.png" style="width: 420px; height: 420px;" /></a>
<a class="reference internal image-reference" href="_images/291dea028b327542e16353282dc72baaecaf822834dcd4b999ec84e3e90f7d24.png"><img alt="_images/291dea028b327542e16353282dc72baaecaf822834dcd4b999ec84e3e90f7d24.png" src="_images/291dea028b327542e16353282dc72baaecaf822834dcd4b999ec84e3e90f7d24.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>The key to understanding the equivalence is recognising that it is only the deviations from the line that are random, whereas the regression equation is fixed. In the first form, this is implicit because we set the mean of the normal distribution (the <em>fixed</em>, <em>predictable</em> or <em>systematic</em> part) to the regression line and then sample data from around that point. In the second form, this is more explicit because we effectively generate the regression line and then <em>add</em> random noise to it.</p>
<p>This second form can be thought of as simply “line + error”. For each value of <span class="math notranslate nohighlight">\(x\)</span>, the line is <em>constant</em>, whereas the data that floats around the line changes with each sample. So it is the <em>deflections from the line</em> that are random, <em>not</em> the line itself. Our systematic variance is fixed and predictable (a <em>constant</em>) whereas the errors changes with each observation (a <em>random variable</em>). We can see this more clearly in the plots below. Adding the first plot to the second plot gives the final model in the third plot. The model is simply the <em>addition</em> of both these elements: the fixed line <em>plus</em> the random error.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">beta.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beta.1</span><span class="o">*</span><span class="n">x</span><span class="p">,</span><span class="w">       </span><span class="n">main</span><span class="o">=</span><span class="s">&quot;Line&quot;</span><span class="p">)</span><span class="w">         </span><span class="c1"># fixed line</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">err</span><span class="p">,</span><span class="w"> </span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">-1.5</span><span class="p">,</span><span class="m">1.5</span><span class="p">),</span><span class="w">   </span><span class="n">main</span><span class="o">=</span><span class="s">&quot;Error&quot;</span><span class="p">)</span><span class="w">        </span><span class="c1"># random error</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">beta.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beta.1</span><span class="o">*</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">err</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="s">&quot;Line + Error&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1"># fixed line + random error (full model)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/67376776603b323baead2c51cbfb086645f4bf1c72901ee3ac93c2477154e54c.png"><img alt="_images/67376776603b323baead2c51cbfb086645f4bf1c72901ee3ac93c2477154e54c.png" src="_images/67376776603b323baead2c51cbfb086645f4bf1c72901ee3ac93c2477154e54c.png" style="width: 420px; height: 420px;" /></a>
<a class="reference internal image-reference" href="_images/292c7ad4c0ce093bc773a5efdf45b8c1cbb94f5e6759a7183d4818b2c460ea20.png"><img alt="_images/292c7ad4c0ce093bc773a5efdf45b8c1cbb94f5e6759a7183d4818b2c460ea20.png" src="_images/292c7ad4c0ce093bc773a5efdf45b8c1cbb94f5e6759a7183d4818b2c460ea20.png" style="width: 420px; height: 420px;" /></a>
<a class="reference internal image-reference" href="_images/0c7a62805045db9c77c2215d291034ab4bf044a24891359dac08d311e3817595.png"><img alt="_images/0c7a62805045db9c77c2215d291034ab4bf044a24891359dac08d311e3817595.png" src="_images/0c7a62805045db9c77c2215d291034ab4bf044a24891359dac08d311e3817595.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<div class="alert alert-block alert-info"> 
<b>ACTIVITY</b> Focus on the plot of errors above. Why is the mean of the errors 0? Why is the data evenly scattered above and below 0? Why does this scattering appear constant for all values of <code>x</code>?
</div></section>
<section id="regression-as-a-mean-and-variance-function">
<h2>Regression as a Mean and Variance Function<a class="headerlink" href="#regression-as-a-mean-and-variance-function" title="Link to this heading">#</a></h2>
<p>To help further conceptualise the regression model, we can return to the concept of a <em>mean function</em> and a <em>variance function</em> from last week. In our previous workshop, we demonstrated the idea of a mean and variance function in <code class="docutils literal notranslate"><span class="pre">R</span></code> as <em>programming functions</em>. We hinted at how this applied to regression, but we will see it more explicitly now.</p>
<p>In terms of code, if we continue with our <code class="docutils literal notranslate"><span class="pre">mpg</span></code> and <code class="docutils literal notranslate"><span class="pre">wt</span></code> example, a simple regression mean and variance function would be</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mean.func</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">mod</span><span class="p">){</span>
<span class="w">    </span><span class="n">beta.0</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">coef</span><span class="p">(</span><span class="n">mod</span><span class="p">)[</span><span class="m">1</span><span class="p">]</span>
<span class="w">    </span><span class="n">beta.1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">coef</span><span class="p">(</span><span class="n">mod</span><span class="p">)[</span><span class="m">2</span><span class="p">]</span>
<span class="w">    </span><span class="n">mu.i</span><span class="w">   </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">beta.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beta.1</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="w">    </span><span class="kr">return</span><span class="p">(</span><span class="n">mu.i</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">var.func</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">mod</span><span class="p">){</span>
<span class="w">    </span><span class="n">sigma</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span><span class="o">$</span><span class="n">sigma</span>
<span class="w">    </span><span class="kr">return</span><span class="p">(</span><span class="n">sigma</span><span class="o">^</span><span class="m">2</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Here, we can see that the mean function implements the <em>rule</em> for calculating the mean based on the parameter values. This rule is given by the regression equation. The variance function does the same thing, but the rule is very simple as it just returns the same quantity, ignoring the specific observation or the specific value of the predictor variable.</p>
<p>One point of connection here is that the <em>predicted</em> or <em>fitted</em> values from the regression model are <em>precisely</em> the results given by the mean function. If we pass the mean function the observed values of our predictor variable, we get the associated points along the regression line. This should not be a surprise. The mean function represents the <em>expected value</em> of the assumed distribution and, in a regression model, those expected values sit along the regression line. For instance, if we know the Weight of a car, then the value of MPG that is most probable is given by the associated point on the regression line. This point represents the mean of the assumed normal distribution of MPG. As such, the regression line represents the <em>systematic</em> variance that we expect to always be stable. Let us see this in code.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">n</span><span class="w">      </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">)</span>
<span class="n">x</span><span class="w">      </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mtcars</span><span class="o">$</span><span class="n">wt</span>
<span class="n">pred.y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="n">mod</span><span class="w">    </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">wt</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">)</span>

<span class="kr">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">n</span><span class="p">){</span>
<span class="w">    </span><span class="n">pred.y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean.func</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">mod</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">fitted</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="s">&quot;mean.func&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pred.y</span><span class="p">,</span>
<span class="w">                 </span><span class="s">&quot;fitted&quot;</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">fit</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                    mean.func    fitted
Mazda RX4           23.282611 23.282611
Mazda RX4 Wag       21.919770 21.919770
Datsun 710          24.885952 24.885952
Hornet 4 Drive      20.102650 20.102650
Hornet Sportabout   18.900144 18.900144
Valiant             18.793255 18.793255
Duster 360          18.205363 18.205363
Merc 240D           20.236262 20.236262
Merc 230            20.450041 20.450041
Merc 280            18.900144 18.900144
Merc 280C           18.900144 18.900144
Merc 450SE          15.533127 15.533127
Merc 450SL          17.350247 17.350247
Merc 450SLC         17.083024 17.083024
Cadillac Fleetwood   9.226650  9.226650
Lincoln Continental  8.296712  8.296712
Chrysler Imperial    8.718926  8.718926
Fiat 128            25.527289 25.527289
Honda Civic         28.653805 28.653805
Toyota Corolla      27.478021 27.478021
Toyota Corona       24.111004 24.111004
Dodge Challenger    18.472586 18.472586
AMC Javelin         18.926866 18.926866
Camaro Z28          16.762355 16.762355
Pontiac Firebird    16.735633 16.735633
Fiat X1-9           26.943574 26.943574
Porsche 914-2       25.847957 25.847957
Lotus Europa        29.198941 29.198941
Ford Pantera L      20.343151 20.343151
Ferrari Dino        22.480940 22.480940
Maserati Bora       18.205363 18.205363
Volvo 142E          22.427495 22.427495
</pre></div>
</div>
</div>
</div>
<p>So, here, we can see that the values returned by the <code class="docutils literal notranslate"><span class="pre">fitted()</span></code> function and the values calculated by our mean function are identical. So, the <em>fitted</em> or <em>predicted</em> values can be conceptualised as the values returned by the mean function. If we then plot these values, it should not be surprising to see that they are <em>exactly</em> the points on the regression line for our measured values of <code class="docutils literal notranslate"><span class="pre">wt</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">plot</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">wt</span><span class="p">,</span><span class="n">pred.y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/eec240ac7ca541f28f03d49b7eaf1c639704101b5cacfec749626deb7b1c9e3d.png"><img alt="_images/eec240ac7ca541f28f03d49b7eaf1c639704101b5cacfec749626deb7b1c9e3d.png" src="_images/eec240ac7ca541f28f03d49b7eaf1c639704101b5cacfec749626deb7b1c9e3d.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>Each one of these points can be conceptualised as the mean of the normal distribution running up the <span class="math notranslate nohighlight">\(y\)</span>-axis, for each value of <code class="docutils literal notranslate"><span class="pre">wt</span></code>. From this perspective, the mean function <em>is</em> our model of the data. It captures the non-random systematic patterns we can see. This is conceptualised in terms of the <em>expected value</em> of a particular probability distribution which, in this example, changes depending upon the value of the predictor variable. This change in the expected values is given <em>precisely</em> by the regression line. Indeed, we can think of the regression line as a representation of how the mean of the normal distribution changes for different values of the predictor variable.</p>
<div class="alert alert-block alert-info"> 
<b>ACTIVITY</b> As well as just predicting values for the current measurements of <code>wt</code>, our mean function allows us to predict values of <code>mpg</code> from <i>any</i> values of <code>wt</code>. Can you use the <code>seq()</code> function to generate an even spread of <code>wt</code> values between 1 and 6? Can you then use the mean function to generate predictions that fill the gap between 4 and 5 we see in the actual data?
</div><p>Note that if we wanted to simulate predicted values from a model in <code class="docutils literal notranslate"><span class="pre">R</span></code>, we do not have to construct our own mean function. Instead, we can use the built-in <code class="docutils literal notranslate"><span class="pre">predict()</span></code> function. This takes as arguments a model and a <em>new</em> data frame containing the values of the predictors we want to use for the simulation. Just be aware that these predictors must be named <em>identically</em> to the originals in order for this to work.</p>
<section id="predictive-accuracy">
<h3>Predictive Accuracy<a class="headerlink" href="#predictive-accuracy" title="Link to this heading">#</a></h3>
<p>Another thing we can do is simulate some data based on this model and see whether it looks similar to the data we have measured. This simulated data will capture the <em>general pattern</em> in the data (the systematic variance) as well as the <em>spread</em> around the regression line (the random error variance). In the example below, we use the <code class="docutils literal notranslate"><span class="pre">seq()</span></code> function to generate a range of <span class="math notranslate nohighlight">\(x\)</span>-values from 1 to 6. We then replicate this range 3 times, so that we will simulate 3 values of <span class="math notranslate nohighlight">\(y\)</span> for each value of <span class="math notranslate nohighlight">\(x\)</span> (to give us some vertical spread). We then simulate each <span class="math notranslate nohighlight">\(y\)</span>-value using the mean and variance functions. The result of the simulation is plotted, with the true data in the plot further below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># control the number of simulated values</span>
<span class="n">n.x</span><span class="w">    </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">50</span>
<span class="n">n.reps</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">3</span>

<span class="c1"># generate x values</span>
<span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="n">from</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="o">=</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="n">length.out</span><span class="o">=</span><span class="n">n.x</span><span class="p">)</span>
<span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">n.reps</span><span class="p">)</span>

<span class="c1"># simulate y</span>
<span class="n">nsubs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">y.sim</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">nsubs</span><span class="p">)</span>
<span class="kr">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">nsubs</span><span class="p">){</span>
<span class="w">    </span><span class="n">y.sim</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="o">=</span><span class="nf">mean.func</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">mod</span><span class="p">),</span><span class="w"> </span><span class="n">sd</span><span class="o">=</span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">var.func</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">mod</span><span class="p">)))</span>
<span class="p">}</span>

<span class="c1"># plot</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y.sim</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="s">&quot;Simulated Weight&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="s">&quot;Simulated MPG&quot;</span><span class="p">)</span>
<span class="nf">abline</span><span class="p">(</span><span class="n">reg</span><span class="o">=</span><span class="n">mod</span><span class="p">)</span>

<span class="nf">plot</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">wt</span><span class="p">,</span><span class="w"> </span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="s">&quot;True Weight&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="s">&quot;True MPG&quot;</span><span class="p">)</span>
<span class="nf">abline</span><span class="p">(</span><span class="n">reg</span><span class="o">=</span><span class="n">mod</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/1a738da4ed4e48431293021d4df39b9871a0420d538e98177403fac8131d58fe.png"><img alt="_images/1a738da4ed4e48431293021d4df39b9871a0420d538e98177403fac8131d58fe.png" src="_images/1a738da4ed4e48431293021d4df39b9871a0420d538e98177403fac8131d58fe.png" style="width: 420px; height: 420px;" /></a>
<a class="reference internal image-reference" href="_images/00f5a9064f30931bce071f9d1ce445064145dc29f933fe7edad806ef81307e19.png"><img alt="_images/00f5a9064f30931bce071f9d1ce445064145dc29f933fe7edad806ef81307e19.png" src="_images/00f5a9064f30931bce071f9d1ce445064145dc29f933fe7edad806ef81307e19.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<div class="alert alert-block alert-info"> 
<b>ACTIVITY</b> Have a play around with the values of <code>n.x</code> and <code>n.reps</code> in the code above. These control how many values of <code>wt</code> are included in the simulations, as well as how many cars at each value of <code>wt</code> we measure.
</div><p>Notice that this simulation does <em>not</em> reflect the fact that, in the real data, at both lower and higher values of <code class="docutils literal notranslate"><span class="pre">wt</span></code>, the measures of <code class="docutils literal notranslate"><span class="pre">mpg</span></code> lie <em>above</em> the regression line. So while this simulation matches some elements of the data, it does not match all of them. Indeed, as we will see in future weeks, a <em>curved</em> line may be a better fit here than a <em>straight</em> line. We can see this as the curved yellow line in the plot below. We will discuss this type of visualisation in more detail a little later on the unit, so do not worry about it for now. Just make sure it is clear that the simulated data is based on assuming the straight-line fit is accurate. The simulation is what our model says the data-generating process is, but we need to be sure that this agrees with what we can <em>actually</em> see.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">suppressMessages</span><span class="p">(</span><span class="nf">library</span><span class="p">(</span><span class="n">effects</span><span class="p">))</span><span class="w">    </span><span class="c1"># stop startup messages being printed</span>
<span class="nf">plot</span><span class="p">(</span><span class="nf">allEffects</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span><span class="w"> </span><span class="n">residuals</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">))</span><span class="w"> </span><span class="c1"># plot the model prediction</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/6875f5a20b1af1ee2471d83bdbd839d05db0e9110a35cca09b5bba260c7c6c0c.png"><img alt="_images/6875f5a20b1af1ee2471d83bdbd839d05db0e9110a35cca09b5bba260c7c6c0c.png" src="_images/6875f5a20b1af1ee2471d83bdbd839d05db0e9110a35cca09b5bba260c7c6c0c.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
</section>
</section>
<section id="intercepts-and-the-r-formula-interface">
<h2>Intercepts and the <code class="docutils literal notranslate"><span class="pre">R</span></code> Formula Interface<a class="headerlink" href="#intercepts-and-the-r-formula-interface" title="Link to this heading">#</a></h2>
<p>In this part of the workshop, we will dig into the <code class="docutils literal notranslate"><span class="pre">R</span></code> formula interface a little more, particularly in relation to the <em>intercept</em> of the regression model. Students can often get confused by the intercept, as well as how it can be specified (or removed) in <code class="docutils literal notranslate"><span class="pre">R</span></code>. We will try to provide some intuition about both these aspects.</p>
<section id="declaring-an-intercept">
<h3>Declaring an Intercept<a class="headerlink" href="#declaring-an-intercept" title="Link to this heading">#</a></h3>
<p>To begin with, all models fit with <code class="docutils literal notranslate"><span class="pre">lm()</span></code> will <em>implicitly</em> contain an intercept. We can make this inclusion more <em>explicit</em> by using the format <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">~</span> <span class="pre">1</span> <span class="pre">+</span> <span class="pre">x1</span></code>. For example</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mod.1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">wt</span><span class="p">,</span><span class="w">     </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">)</span><span class="w"> </span><span class="c1"># intercept implied</span>
<span class="n">mod.2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">wt</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">)</span><span class="w"> </span><span class="c1"># intercept explicit</span>

<span class="n">mod.1</span>
<span class="n">mod.2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = mpg ~ wt, data = mtcars)

Coefficients:
(Intercept)           wt  
     37.285       -5.344  
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = mpg ~ 1 + wt, data = mtcars)

Coefficients:
(Intercept)           wt  
     37.285       -5.344  
</pre></div>
</div>
</div>
</div>
<p>As we can see, these two models are <em>identical</em>, so it really depends upon whether you find the explicit declaration of the intercept more appealing, or are happy to leave it out.</p>
</section>
<section id="removing-the-intercept">
<h3>Removing the Intercept<a class="headerlink" href="#removing-the-intercept" title="Link to this heading">#</a></h3>
<p>Because the intercept is always <em>implicit</em>, it we want to remove it from the model we have to ask <code class="docutils literal notranslate"><span class="pre">lm()</span></code> to do this. There are two ways to go about this. We either mirror the explicit declaration of an intercept and replace the <code class="docutils literal notranslate"><span class="pre">1</span></code> with a <code class="docutils literal notranslate"><span class="pre">0</span></code>, or we use a <code class="docutils literal notranslate"><span class="pre">-</span> <span class="pre">1</span></code> to tell <code class="docutils literal notranslate"><span class="pre">lm()</span></code> to <em>remove</em> the intercept. We can also do both, if we like being unnecessarily verbose. For example</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mod.1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">wt</span><span class="p">,</span><span class="w">     </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">)</span><span class="w"> </span><span class="c1"># an intercept of 0</span>
<span class="n">mod.2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">wt</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w">     </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">)</span><span class="w"> </span><span class="c1"># remove intercept</span>
<span class="n">mod.3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">wt</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">)</span><span class="w"> </span><span class="c1"># include intercept, then remove it</span>

<span class="n">mod.1</span>
<span class="n">mod.2</span>
<span class="n">mod.3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = mpg ~ 0 + wt, data = mtcars)

Coefficients:
   wt  
5.292  
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = mpg ~ wt - 1, data = mtcars)

Coefficients:
   wt  
5.292  
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = mpg ~ 1 + wt - 1, data = mtcars)

Coefficients:
   wt  
5.292  
</pre></div>
</div>
</div>
</div>
<p>You can use whichever format feels most intuitive to you. Most examples of <code class="docutils literal notranslate"><span class="pre">lm()</span></code> that you will see use the <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">~</span> <span class="pre">x1</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">~</span> <span class="pre">x1</span> <span class="pre">-</span> <span class="pre">1</span></code> formats, though you may personally prefer <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">~</span> <span class="pre">1</span> <span class="pre">+</span> <span class="pre">x1</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">~</span> <span class="pre">0</span> <span class="pre">+</span> <span class="pre">x1</span></code> as it makes the model form clearer. Just note that if you want a model that <em>only</em> contains an intercept, the only option is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">)</span><span class="w"> </span><span class="c1"># intercept only</span>
<span class="n">mod</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = mpg ~ 1, data = mtcars)

Coefficients:
(Intercept)  
      20.09  
</pre></div>
</div>
</div>
</div>
<p>You can even specify a model without anything in it by writing an intercept-only model using <code class="docutils literal notranslate"><span class="pre">0</span></code>. Why you would want this is anyone’s guess, but it is possible.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">)</span><span class="w"> </span><span class="c1"># model containing nothing</span>
<span class="n">mod</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = mpg ~ 0, data = mtcars)

No coefficients
</pre></div>
</div>
</div>
</div>
</section>
<section id="formula-shortcuts">
<h3>Formula Shortcuts<a class="headerlink" href="#formula-shortcuts" title="Link to this heading">#</a></h3>
<p>There are also some other symbols you can use in the model formula as shortcuts. For instance, using <code class="docutils literal notranslate"><span class="pre">.</span></code> instead of the variable names means “include everything in the dataset”. So, if we did that here, we get a model that contains <em>everything</em> from <code class="docutils literal notranslate"><span class="pre">mtcars</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mod.all</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">)</span>
<span class="n">mod.all</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = mpg ~ ., data = mtcars)

Coefficients:
(Intercept)          cyl         disp           hp         drat           wt  
   12.30337     -0.11144      0.01334     -0.02148      0.78711     -3.71530  
       qsec           vs           am         gear         carb  
    0.82104      0.31776      2.52023      0.65541     -0.19942  
</pre></div>
</div>
</div>
</div>
<p>We can also use the <code class="docutils literal notranslate"><span class="pre">-</span></code> symbol to exclude certain variables. For instance, to include everything <em>except</em> <code class="docutils literal notranslate"><span class="pre">gear</span></code> and <code class="docutils literal notranslate"><span class="pre">drat</span></code>, we would use</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mod.nogear</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gear</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">drat</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">)</span>
<span class="n">mod.nogear</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = mpg ~ . - gear - drat, data = mtcars)

Coefficients:
(Intercept)          cyl         disp           hp           wt         qsec  
   20.02854     -0.43642      0.01508     -0.02153     -4.04437      0.77905  
         vs           am         carb  
    0.39393      2.99477      0.05700  
</pre></div>
</div>
</div>
</div>
<p>If we then wanted to add <code class="docutils literal notranslate"><span class="pre">gear</span></code> in, we can either respecify the model using <code class="docutils literal notranslate"><span class="pre">lm()</span></code>, or we can use the <code class="docutils literal notranslate"><span class="pre">update()</span></code> function like so</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mod.withgear</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="n">mod.nogear</span><span class="p">,</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gear</span><span class="p">)</span>
<span class="n">mod.withgear</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = mpg ~ cyl + disp + hp + wt + qsec + vs + am + carb + 
    gear, data = mtcars)

Coefficients:
(Intercept)          cyl         disp           hp           wt         qsec  
   16.11226     -0.25012      0.01433     -0.02239     -3.86886      0.80826  
         vs           am         carb         gear  
    0.34789      2.67505     -0.11710      0.70926  
</pre></div>
</div>
</div>
</div>
<p>Here, the <code class="docutils literal notranslate"><span class="pre">.</span></code> in the formula simply means “include everything that was included before”.</p>
</section>
<section id="regression-through-the-origin">
<h3>Regression Through the Origin<a class="headerlink" href="#regression-through-the-origin" title="Link to this heading">#</a></h3>
<p>Returning to the idea of <em>removing</em> an intercept, sometimes the temptation is to exclude an intercept term when we feel that a value of 0 on the predictor variable should be matched with a predicted value of 0. For instance, in the case of <code class="docutils literal notranslate"><span class="pre">wt</span></code> it feels more sensible to have the model predict that a car with 0 weight has an MPG of 0. However, this is not always the best choice.</p>
<p>To see this, we will specify the model between <code class="docutils literal notranslate"><span class="pre">wt</span></code> and <code class="docutils literal notranslate"><span class="pre">mpg</span></code> <em>without</em> an intercept. This is known as a <em>regression through the origin</em>. We plot the results of this below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">reg.through.orig</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm </span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">wt</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">mtcars</span><span class="o">$</span><span class="n">wt</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">,</span><span class="w"> </span><span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">5.5</span><span class="p">),</span><span class="w"> </span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">35</span><span class="p">))</span>
<span class="nf">abline</span><span class="p">(</span><span class="n">reg</span><span class="o">=</span><span class="n">reg.through.orig</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/41c068dad668f6e2712711b1464c2a16476256c06e5a8b650520e6d4be4305fe.png"><img alt="_images/41c068dad668f6e2712711b1464c2a16476256c06e5a8b650520e6d4be4305fe.png" src="_images/41c068dad668f6e2712711b1464c2a16476256c06e5a8b650520e6d4be4305fe.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>So, we now have a model where the prediction for a weight of 0 is indeed 0 MPG. So this is good. Unfortunately, we cannot say the same for anything else about this model. While <em>technically</em> the prediction for a weight of 0 is now sensible, forcing a straight line to pass through 0 clearly does not match the actual data.</p>
<p>The way to think about this type of model is that it needs to be <em>constrained</em> to only a sensible range of the <code class="docutils literal notranslate"><span class="pre">wt</span></code> variable. Cars will have a minimum and maximum weight. Any value <em>outside</em> that range is uninterpretable and should be ignored. Indeed, a car with a weight of 0 is a nonsense. Even if the regression model can technically calculate MPG for an infinite range of weights, the problem itself should constrain the use of this model to only realistic values. As such, the fact that the intercept is not very meaningfully can simply be ignored.</p>
</section>
<section id="mean-centering">
<h3>Mean Centering<a class="headerlink" href="#mean-centering" title="Link to this heading">#</a></h3>
<p>As an alternative, if we find the interpretation of the intercept particularly distasteful, we can choose to <em>mean-centre</em> the weight variable. This is a simple operation where we subtract the mean of weight from each observation. This renders the average of the centred variable 0, with each observation now representing a <em>deflection</em> from the mean. Let us see what this does to the intercept parameter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">wt.cent</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mtcars</span><span class="o">$</span><span class="n">wt</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">wt</span><span class="p">)</span>
<span class="n">reg.cent</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">wt.cent</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">reg.cent</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = mpg ~ wt.cent, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5432 -2.3647 -0.1252  1.4096  6.8727 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  20.0906     0.5384  37.313  &lt; 2e-16 ***
wt.cent      -5.3445     0.5591  -9.559 1.29e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 3.046 on 30 degrees of freedom
Multiple R-squared:  0.7528,	Adjusted R-squared:  0.7446 
F-statistic: 91.38 on 1 and 30 DF,  p-value: 1.294e-10
</pre></div>
</div>
</div>
</div>
<p>So now, the value of the intercept is the estimated MPG for an <em>average</em> value of <code class="docutils literal notranslate"><span class="pre">wt</span></code>. This is potentially more helpful, because we can see that an average car (in terms of weight) has an associated fuel efficiency of around 20.1 MPG. Of importance, notice that the value of the <em>slope</em> is identical to the non-centred model. The only thing that centering changes is the intercept. We can see this by plotting the model fit.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">wt.cent</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="s">&quot;Weight (centred)&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="s">&quot;MPG&quot;</span><span class="p">)</span>
<span class="nf">abline</span><span class="p">(</span><span class="n">reg</span><span class="o">=</span><span class="n">reg.cent</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/17c1d94b9e8f316264f411fbe5c370790ff1881680cd7b6162eaba8e2495776b.png"><img alt="_images/17c1d94b9e8f316264f411fbe5c370790ff1881680cd7b6162eaba8e2495776b.png" src="_images/17c1d94b9e8f316264f411fbe5c370790ff1881680cd7b6162eaba8e2495776b.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>We could also centre the MPG variable. This would render the average value of MPG for an average value of Weight 0. This means we can drop the intercept and return to regression through the origin. This is because the origin now sits in the <em>middle</em> of our data, rather than miles away from the data (as was the case before).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">wt.cent</span><span class="w">    </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mtcars</span><span class="o">$</span><span class="n">wt</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">wt</span><span class="p">)</span>
<span class="n">mpg.cent</span><span class="w">   </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">)</span>
<span class="n">reg.cent.2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg.cent</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">wt.cent</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">)</span><span class="w"> </span><span class="c1"># or mpg.cent ~ wt.cent - 1</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">reg.cent.2</span><span class="p">)</span>

<span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">wt.cent</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">mpg.cent</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="s">&quot;Weight (centred)&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="s">&quot;MPG (centred)&quot;</span><span class="p">)</span>
<span class="nf">abline</span><span class="p">(</span><span class="n">reg</span><span class="o">=</span><span class="n">reg.cent.2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = mpg.cent ~ 0 + wt.cent, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5432 -2.3647 -0.1252  1.4096  6.8727 

Coefficients:
        Estimate Std. Error t value Pr(&gt;|t|)    
wt.cent   -5.345      0.550  -9.717 6.33e-11 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.996 on 31 degrees of freedom
Multiple R-squared:  0.7528,	Adjusted R-squared:  0.7449 
F-statistic: 94.42 on 1 and 31 DF,  p-value: 6.332e-11
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/c0ebc47ac04283d9e2a6e288010173d3444c5767c7be8a9a1c9488b7057b026b.png"><img alt="_images/c0ebc47ac04283d9e2a6e288010173d3444c5767c7be8a9a1c9488b7057b026b.png" src="_images/c0ebc47ac04283d9e2a6e288010173d3444c5767c7be8a9a1c9488b7057b026b.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>Notice that the fit is exactly the same, we have just removed the need for an intercept. In practice, there is often little call for doing this, especially as it then causes some interpretational issues given the mean-centered scales. This can be overcome by adding the means back in when visualising the model fit, but this usually just amounts to unnecessary fiddling for limited gain. <em>However</em>, this can be instructive in terms of understanding how regression models work and why the intercept is there in the first place.</p>
</section>
</section>
<section id="visualising-regression">
<h2>Visualising Regression<a class="headerlink" href="#visualising-regression" title="Link to this heading">#</a></h2>
<p>As a final topic in this workshop, we will discuss more about visualising regression models. Although the base <code class="docutils literal notranslate"><span class="pre">R</span></code> graphics are perfectly serviceable, in terms of publication it is likely you will want to use a dedicated plotting library, such as <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code>. In the sections below, we will provide examples of plotting simple regression and multiple regression in <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code>. We will then provide a final example in base <code class="docutils literal notranslate"><span class="pre">R</span></code> of plotting the 3-dimensional regression plane, for situations where you may find this useful.</p>
<section id="simple-regession-and-ggplot2">
<h3>Simple Regession and <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code><a class="headerlink" href="#simple-regession-and-ggplot2" title="Link to this heading">#</a></h3>
<p>The code below provides a basic example of plotting simple regression using the <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code> framework. This is clearly more verbose and more effort than base <code class="docutils literal notranslate"><span class="pre">R</span></code>, but for the purpose of creating high-quality visualisations, there are few more powerful alternatives.</p>
<div class="alert alert-block alert-danger"> 
<b>IMPORTANT</b> Make sure you do not spend lots of time playing around with making plots pretty in a context where it does not matter. For example, in the context of something like a data analysis report, it is rarely worth your time. This effort should only really be spent when you are publishing work or including results in a presentation or poster. So, although tempting, make sure you do not get side-tracked playing with <code>ggplot2</code> in a context where it is not necessary.
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>

<span class="n">mod</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">wt</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">)</span>
<span class="n">beta</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">coef</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span>

<span class="nf">ggplot</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">wt</span><span class="p">,</span><span class="w"> </span><span class="n">mpg</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">    </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="s">&quot;cornflowerblue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="o">=</span><span class="m">21</span><span class="p">,</span><span class="w"> </span><span class="n">stroke</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_abline</span><span class="p">(</span><span class="n">intercept</span><span class="o">=</span><span class="n">beta</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">slope</span><span class="o">=</span><span class="n">beta</span><span class="p">[</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="n">linewidth</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">labs</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&quot;Regression of MPG and Weight&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="o">=</span><span class="s">&quot;Weight (1000 lbs)&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="s">&quot;MPG&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">    </span><span class="nf">theme_bw</span><span class="p">(</span><span class="n">base_size</span><span class="o">=</span><span class="m">18</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">    </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="o">=</span><span class="nf">element_text</span><span class="p">(</span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/3b80ed57d85a43675e81a6dd76380f41aa43a7392ace7d38093b0b9624589344.png"><img alt="_images/3b80ed57d85a43675e81a6dd76380f41aa43a7392ace7d38093b0b9624589344.png" src="_images/3b80ed57d85a43675e81a6dd76380f41aa43a7392ace7d38093b0b9624589344.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<div class="alert alert-block alert-info"> 
<b>ACTIVITY</b> Have a play around with all the numeric graphical parameters (e.g. <code>size</code>, <code>pch</code>, <code>stroke</code>, <code>base_size</code> etc.) and the colour parameters (e.g. <code>fill</code> and <code>colour</code>) to change how the plot is displayed. This should give you a good sense of the flexibility of the visualisation. You could try changing <code>theme_bw</code> to something else as well (you can search online for <code>ggplot2 themes</code>).
</div></section>
<section id="multiple-regression-and-ggplot2">
<h3>Multiple Regression and <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code><a class="headerlink" href="#multiple-regression-and-ggplot2" title="Link to this heading">#</a></h3>
<p>In the case of multiple regression, things are a little more complex because we need to use <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code> to create <em>added variable</em> plots. This means we need to <em>residualise</em> each variable in terms of all other variables in the model before plotting.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Full model</span>
<span class="n">multi.reg</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">wt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">hp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">disp</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">)</span>

<span class="c1">#======================================================================================#</span>
<span class="c1"># Plot Weight</span>
<span class="c1">#======================================================================================#</span>

<span class="c1"># Residualise the variables</span>
<span class="n">mpg.resid</span><span class="w">   </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">resid</span><span class="p">(</span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">hp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">disp</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">))</span>
<span class="n">wt.resid</span><span class="w">    </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">resid</span><span class="p">(</span><span class="nf">lm</span><span class="p">(</span><span class="w"> </span><span class="n">wt</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">hp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">disp</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">))</span>
<span class="n">add.var.mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg.resid</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">wt.resid</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>

<span class="c1"># Data for plotting</span>
<span class="n">plot.data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="s">&quot;mpg&quot;</span><span class="o">=</span><span class="n">mpg.resid</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;wt&quot;</span><span class="o">=</span><span class="n">wt.resid</span><span class="p">)</span>
<span class="n">beta</span><span class="w">      </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">coef</span><span class="p">(</span><span class="n">add.var.mod</span><span class="p">)</span>

<span class="c1"># Create plot</span>
<span class="nf">ggplot</span><span class="p">(</span><span class="n">plot.data</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">wt</span><span class="p">,</span><span class="w"> </span><span class="n">mpg</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">    </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="s">&quot;cornflowerblue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="o">=</span><span class="m">21</span><span class="p">,</span><span class="w"> </span><span class="n">stroke</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_abline</span><span class="p">(</span><span class="n">intercept</span><span class="o">=</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">slope</span><span class="o">=</span><span class="n">beta</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">linewidth</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">labs</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&quot;Added Variable Plot&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="o">=</span><span class="s">&quot;Weight (Corrected)&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="s">&quot;MPG (Corrected)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">    </span><span class="nf">theme_bw</span><span class="p">(</span><span class="n">base_size</span><span class="o">=</span><span class="m">18</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">    </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="o">=</span><span class="nf">element_text</span><span class="p">(</span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/2828c7a2d9bbb0e2b0e7e41f5a0b651d055cc7acdb2f474902112059d627b876.png"><img alt="_images/2828c7a2d9bbb0e2b0e7e41f5a0b651d055cc7acdb2f474902112059d627b876.png" src="_images/2828c7a2d9bbb0e2b0e7e41f5a0b651d055cc7acdb2f474902112059d627b876.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#======================================================================================#</span>
<span class="c1"># Plot Horsepower</span>
<span class="c1">#======================================================================================#</span>

<span class="c1"># Residualise the variables</span>
<span class="n">mpg.resid</span><span class="w">   </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">resid</span><span class="p">(</span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">wt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">disp</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">))</span>
<span class="n">hp.resid</span><span class="w">    </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">resid</span><span class="p">(</span><span class="nf">lm</span><span class="p">(</span><span class="w"> </span><span class="n">hp</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">wt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">disp</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">))</span>
<span class="n">add.var.mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg.resid</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">hp.resid</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>

<span class="c1"># Data for plotting</span>
<span class="n">plot.data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="s">&quot;mpg&quot;</span><span class="o">=</span><span class="n">mpg.resid</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hp&quot;</span><span class="o">=</span><span class="n">hp.resid</span><span class="p">)</span>
<span class="n">beta</span><span class="w">      </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">coef</span><span class="p">(</span><span class="n">add.var.mod</span><span class="p">)</span>

<span class="c1"># Create plot</span>
<span class="nf">ggplot</span><span class="p">(</span><span class="n">plot.data</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">hp</span><span class="p">,</span><span class="w"> </span><span class="n">mpg</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">    </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="s">&quot;cornflowerblue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="o">=</span><span class="m">21</span><span class="p">,</span><span class="w"> </span><span class="n">stroke</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_abline</span><span class="p">(</span><span class="n">intercept</span><span class="o">=</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">slope</span><span class="o">=</span><span class="n">beta</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">linewidth</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">labs</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&quot;Added Variable Plot&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="o">=</span><span class="s">&quot;Horsepower (Corrected)&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="s">&quot;MPG (Corrected)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">    </span><span class="nf">theme_bw</span><span class="p">(</span><span class="n">base_size</span><span class="o">=</span><span class="m">18</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">    </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="o">=</span><span class="nf">element_text</span><span class="p">(</span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/1593f24e592c60127f18d0f53a0d2ec107cf3c8e1be1a4659a9e43340e1aca0d.png"><img alt="_images/1593f24e592c60127f18d0f53a0d2ec107cf3c8e1be1a4659a9e43340e1aca0d.png" src="_images/1593f24e592c60127f18d0f53a0d2ec107cf3c8e1be1a4659a9e43340e1aca0d.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<div class="alert alert-block alert-info"> 
<b>ACTIVITY</b> Can you use the pattern here to create the added variable plot for <code>disp</code>? 
</div></section>
<section id="visualising-the-regression-plane">
<h3>Visualising the Regression Plane<a class="headerlink" href="#visualising-the-regression-plane" title="Link to this heading">#</a></h3>
<p>As a final topic, you may want to visualise the regression plane when you have a multiple regression with two predictor variables. Although advanced 3D rendering packages such as <code class="docutils literal notranslate"><span class="pre">rgl</span></code> exist, the most simple non-interactive 3D scatter plot with the regression plane can be created in base <code class="docutils literal notranslate"><span class="pre">R</span></code> using the code below. You do not need to understand all of this, but could easily adapt it for any of your own two-variable regression models.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># data (just change this in future)</span>
<span class="n">y</span><span class="w">       </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span>
<span class="n">x1</span><span class="w">      </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mtcars</span><span class="o">$</span><span class="n">wt</span>
<span class="n">x2</span><span class="w">      </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mtcars</span><span class="o">$</span><span class="n">hp</span>
<span class="n">x.label</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;Weight&quot;</span>
<span class="n">y.label</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;Horsepower&quot;</span>
<span class="n">z.label</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;MPG&quot;</span>

<span class="c1"># model</span>
<span class="n">plot.mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">x1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x2</span><span class="p">)</span>

<span class="c1"># regression plane as a grid</span>
<span class="n">x.axis</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="nf">min</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span><span class="w"> </span><span class="n">length.out</span><span class="o">=</span><span class="m">30</span><span class="p">)</span><span class="w">   </span><span class="c1"># x-axis</span>
<span class="n">y.axis</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="nf">min</span><span class="p">(</span><span class="n">x2</span><span class="p">),</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">x2</span><span class="p">),</span><span class="w"> </span><span class="n">length.out</span><span class="o">=</span><span class="m">30</span><span class="p">)</span><span class="w">   </span><span class="c1"># z-axis</span>
<span class="n">grid</span><span class="w">    </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">expand.grid</span><span class="p">(</span><span class="n">x1</span><span class="o">=</span><span class="n">x.axis</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="o">=</span><span class="n">y.axis</span><span class="p">)</span>
<span class="n">fit</span><span class="w">     </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">matrix</span><span class="p">(</span><span class="nf">predict</span><span class="p">(</span><span class="n">plot.mod</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="o">=</span><span class="n">grid</span><span class="p">),</span><span class="w"> </span><span class="n">nrow</span><span class="o">=</span><span class="nf">length</span><span class="p">(</span><span class="n">x.axis</span><span class="p">),</span><span class="w"> </span><span class="n">ncol</span><span class="o">=</span><span class="nf">length</span><span class="p">(</span><span class="n">y.axis</span><span class="p">))</span>

<span class="c1"># draw regression plane</span>
<span class="n">pr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">persp</span><span class="p">(</span><span class="n">x.axis</span><span class="p">,</span><span class="w"> </span><span class="n">y.axis</span><span class="p">,</span><span class="w"> </span><span class="n">fit</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="n">x.label</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="n">y.label</span><span class="p">,</span><span class="w"> </span><span class="n">zlab</span><span class="o">=</span><span class="n">z.label</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">theta</span><span class="o">=</span><span class="m">50</span><span class="p">,</span><span class="w"> </span><span class="n">phi</span><span class="o">=</span><span class="m">20</span><span class="p">)</span>

<span class="c1"># Add data points</span>
<span class="nf">points</span><span class="p">(</span><span class="nf">trans3d</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">pr</span><span class="p">),</span><span class="w"> </span><span class="n">pch</span><span class="o">=</span><span class="m">19</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="o">=</span><span class="m">1.5</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/45785f32c47e6eb5695c3e1bb47446004e2dfcadfacb7e7519825f8f6a0e9937.png"><img alt="_images/45785f32c47e6eb5695c3e1bb47446004e2dfcadfacb7e7519825f8f6a0e9937.png" src="_images/45785f32c47e6eb5695c3e1bb47446004e2dfcadfacb7e7519825f8f6a0e9937.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<div class="alert alert-block alert-info"> 
<b>ACTIVITY</b> Try changing the values of <code>theta</code> and <code>phi</code> to change the perspective of the visualisation. You can also change the value of <code>pch</code> to change the symbol used for the data points (refer to a website such as <a href="https://www.r-bloggers.com/2021/06/r-plot-pch-symbols-different-point-shapes-in-r/">this</a> to see all the symbols available), change the value of <code>cex</code> to adjust the symbol size and change the colour of the points to whatever you like. You could also try replacing the variables and labels with other options from <code>mtcars</code>, to see how this visualisation can be easily adpated.
</div></section>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h2>
<p>In this workshop, we have covered several aspects of the multiple regression framework. All the chosen topics have been designed to give you a <em>deeper</em> and <em>more intuitive</em> understanding of regression. However, at this point, you may not fully understand all of this. That is perfectly fine. As mentioned last week, learning is <em>iterative</em>. As a first pass, it is just good to be <em>aware</em> of some of these topics. As you progress, you will absorb more information and then can use that understanding to come back and try and tackle those topics that you struggled with. Eventually, things will fall into place. Sometimes, these struggles relate to some fundamental misunderstand that will eventually be corrected. Other times, it can be at the point of <em>applying</em> these methods to your own problems that some of these topics become clearer. At any rate, your are on a journey at present and we have not reached our destination. So, try to do your best with all of this, but know that the only way to really absorb any of this is to keep going over it again and again. Eventually, it will become second nature.</p>
<div class="alert alert-block alert-warning"> 
<b>TEST QUESTIONS</b> 
<p>Use the questions below to check your understanding of all the materials from this week.</p>
<ol class="arabic simple">
<li><p>What definition of “best” is used when defining the least-squares regression line?</p></li>
<li><p>Why is the <i>log</i> likelihood used, rather than the likelihood itself, with iterative maximum likelihood methods?</p></li>
<li><p>Why do the errors in linear regression have a mean of 0?</p></li>
<li><p>What is the connection between the fitted values returned by <code>lm()</code> and the mean function?</p></li>
<li><p>What are the two ways you can specify an intercept using the <code>lm()</code> formula interface?</p></li>
<li><p>What are the two ways you can specify <i>no</i> intercept using the <code>lm()</code> formula interface?</p></li>
<li><p>What element of the model does <i>mean centering</i> affect?</p></li>
<li><p>How does the interpretation of this element change after mean centering?</p></li>
<li><p>Under what circumstance would regression through the origin not change the slope parameter?</p></li>
<li><p>Why are added variable plots necessary in multiple regression?</p></li>
</ol>
</div></section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#minimising-error-with-a-line">Minimising Error With a Line</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#maximum-likelihood">Maximum Likelihood</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#different-model-equations">Different Model Equations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regression-as-a-mean-and-variance-function">Regression as a Mean and Variance Function</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#predictive-accuracy">Predictive Accuracy</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#intercepts-and-the-r-formula-interface">Intercepts and the <code class="docutils literal notranslate"><span class="pre">R</span></code> Formula Interface</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#declaring-an-intercept">Declaring an Intercept</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#removing-the-intercept">Removing the Intercept</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#formula-shortcuts">Formula Shortcuts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regression-through-the-origin">Regression Through the Origin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-centering">Mean Centering</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualising-regression">Visualising Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-regession-and-ggplot2">Simple Regession and <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-regression-and-ggplot2">Multiple Regression and <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualising-the-regression-plane">Visualising the Regression Plane</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dr Martyn McFarquhar & Dr George Farmer
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2026.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>